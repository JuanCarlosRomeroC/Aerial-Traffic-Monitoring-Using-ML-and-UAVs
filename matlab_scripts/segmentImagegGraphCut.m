I = imread('testImage1.jpg');



function [BW,maskedImage] = segmentImage(RGB)
%segmentImage Segment image using auto-generated code from imageSegmenter app
%  [BW,MASKEDIMAGE] = segmentImage(RGB) segments image RGB using
%  auto-generated code from the imageSegmenter app. The final segmentation
%  is returned in BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 15-Feb-2019
%----------------------------------------------------


% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Graph cut
foregroundInd = [490 491 969 972 973 1449 1453 1454 1455 1928 1936 1937 2417 2418 2888 2899 3368 3379 3380 3849 3860 4329 4340 4809 4820 5289 5300 5769 5780 5781 6249 6730 6742 7210 7222 7223 7704 8171 8184 8652 8665 8666 9132 9133 9146 9613 9614 9627 10094 10095 10108 10576 10577 10589 11058 11069 11538 11549 12019 12029 12500 12509 12980 12981 13462 13469 13943 13948 14424 14425 14426 14427 14428 25488 25489 25966 25967 25969 25970 26446 26451 26926 26932 27405 27413 27882 27884 27885 27894 27895 28363 28376 28377 28843 28857 28858 29294 29295 29296 29324 29338 29773 29774 29777 29778 29805 29819 29820 30253 30258 30286 30300 30301 30732 30733 30738 30739 30766 30781 31201 31202 31212 31219 31246 31262 31681 31682 31691 31700 31726 31743 32161 32162 32171 32180 32181 32207 32224 32641 32643 32652 32662 32687 32688 32704 33121 33124 33132 33142 33168 33184 33601 33604 33605 33613 33623 33649 33664 34086 34093 34103 34104 34130 34144 34561 34566 34567 34574 34575 34585 34610 34624 35047 35056 35091 35092 35104 35528 35536 35546 35572 35583 35584 36009 36026 36053 36489 36497 36507 36508 36534 36535 36543 36970 36978 36989 37015 37022 37023 37441 37451 37452 37470 37496 37502 37933 37938 37950 37976 37977 37981 38401 38414 38419 38431 38457 38458 38461 38881 38895 38899 38912 38938 38939 38940 39362 39376 39379 39842 39857 39860 39873 40322 40338 40341 40353 40802 40818 40822 40833 41282 41299 41302 41303 41313 41762 41780 41783 41784 41792 42242 42260 42264 42272 42721 42722 42741 42745 42746 42752 43202 43226 43227 43232 43266 43270 43682 43683 43703 43708 43709 43711 43745 43746 43747 43748 43749 43751 43752 44162 44163 44183 44189 44190 44191 44225 44232 44233 44644 44664 44704 44705 44713 44714 45125 45144 45185 45195 45605 45625 45665 45666 45676 46086 46105 46147 46157 46566 46567 46586 46598 46599 46600 46601 46602 46628 46638 47047 47067 47077 47082 47083 47108 47118 47119 47528 47529 47547 47556 47563 47564 47589 47599 48009 48027 48036 48044 48069 48080 48489 48490 48507 48525 48561 48970 48987 48995 48996 49005 49030 49041 49042 49451 49476 49486 49511 49522 49931 49947 49957 49967 49992 50002 50412 50427 50437 50448 50482 50893 50907 50917 50929 50952 51374 51387 51397 51410 51433 51442 51854 51855 51867 51877 51878 51890 51913 52335 52336 52347 52358 52371 52372 52393 52402 52816 52817 52826 52839 52852 52853 52874 52882 53297 53298 53304 53306 53320 53333 53334 53354 53362 53779 53780 53781 53782 53783 53800 53801 53814 53815 53835 53842 54282 54295 54296 54315 54322 54763 54776 54796 54801 55244 55256 55276 55281 55724 55725 55736 55757 55758 55759 55760 55761 56206 56216 56686 56687 56696 57168 57176 57212 57213 57628 57629 57630 57631 57648 57649 57692 57694 57695 58108 58112 58129 58130 58136 58171 58175 58176 58587 58588 58593 58610 58611 58616 58649 58650 58657 59067 59073 59091 59096 59128 59129 59137 59138 59545 59546 59547 59554 59555 59571 59572 59575 59607 59608 59618 60025 60036 60053 60054 60055 60088 60099 60504 60505 60516 60517 60567 60580 60984 60998 60999 61046 61060 61061 61465 61479 61528 61542 61946 61960 61961 62022 62426 62441 62503 62907 62922 62969 62984 63387 63403 63450 63465 63868 63884 63931 63945 64349 64364 64426 64829 64830 64844 64892 64907 65310 65324 65372 65790 65804 65853 65854 65867 65868 66271 66284 66334 66348 66752 66764 66815 66828 67233 67244 67264 67265 67266 67267 67296 67308 67714 67724 67743 67744 67748 67749 67750 67777 67788 68195 68196 68204 68223 68230 68231 68258 68268 68676 68683 68703 68712 68739 68747 68748 69157 69163 69181 69182 69183 69193 69219 69220 69638 69639 69643 69662 69674 69700 69707 70120 70121 70122 70143 70154 70155 70181 70186 70623 70635 70661 70662 70666 71104 71116 71142 71143 71144 71145 71585 71596 72023 72024 72025 72027 72030 72031 72058 72059 72065 72077 72503 72512 72537 72538 72540 72541 72546 72558 72559 72993 73016 73022 73039 73459 73460 73462 73474 73496 73502 73507 73508 73520 73521 73941 73956 73975 74032 74033 74034 74035 74036 74037 74038 74421 74422 74436 74454 74463 74468 74482 74511 74512 74518 74519 74903 74934 74943 74949 74963 74991 75000 75397 75410 75413 75424 75430 75444 75470 75481 75863 75892 75924 75950 75961 75962 76344 76357 76385 76391 76404 76429 76443 76825 76851 76852 76871 76884 76909 76923 77318 77331 77345 77352 77353 77364 77404 77785 77833 77844 77869 77884 78266 78306 78314 78324 78349 78365 78758 78794 78795 78803 78830 78845 79253 79267 79275 79276 79283 79311 79326 79706 79718 79734 79757 79762 79792 79807 80198 80215 80228 80238 80239 80241 80242 80272 80667 80678 80695 80708 80719 80720 80753 80767 81157 81233 81247 81248 81636 81656 81657 81668 81714 81728 82107 82116 82137 82194 82208 82574 82575 82576 82577 82579 82580 82588 82595 82618 82628 82675 82688 83053 83060 83061 83068 83069 83070 83071 83072 83073 83074 83099 83108 83168 83532 83541 83542 83579 83580 83636 83648 84011 84012 84023 84062 84068 84116 84128 84491 84492 84519 84520 84521 84523 84542 84544 84546 84547 84596 84597 84607 84966 84967 84968 84969 84970 84972 84984 85004 85077 85078 85087 85444 85445 85450 85451 85453 85465 85478 85485 85558 85559 85566 85923 85924 85931 85933 85945 85966 86039 86040 86041 86045 86046 86403 86414 86437 86447 86464 86465 86466 86467 86468 86521 86522 86523 86524 86525 86882 86892 86895 86906 86907 86915 86917 86927 86943 86949 86950 87362 87373 87375 87376 87387 87408 87409 87423 87431 87842 87854 87856 87867 87877 87890 87902 87903 87913 88322 88335 88337 88348 88382 88383 88394 88815 88818 88828 88838 88852 88863 88875 89282 89296 89298 89308 89333 89344 89356 89762 89777 89778 89789 89814 89824 89837 90243 90257 90259 90269 90281 90305 90317 90723 90737 90749 90775 90786 90798 91204 91218 91220 91230 91255 91267 91268 91685 91698 91699 91701 91710 91722 91748 91758 92165 92179 92181 92182 92190 92215 92229 92239 92646 92659 92660 92671 92672 92683 92710 92719 93140 93143 93152 93199 93607 93608 93620 93623 93633 93644 93655 93671 93680 94088 94101 94104 94113 94125 94151 94160 94569 94582 94585 94593 94606 94615 94632 95050 95062 95065 95066 95073 95086 95095 95113 95120 95531 95543 95547 95553 95567 95593 95594 95600 96011 96012 96023 96028 96029 96030 96031 96032 96055 96074 96075 96080 96492 96504 96527 96535 96556 96557 96973 96984 97008 97015 97037 97038 97040 97453 97464 97495 97501 97502 97504 97505 97934 97944 97969 97970 97986 98415 98424 98451 98453 98454 98459 98466 98467 98896 98903 98947 99377 99378 99379 99380 99381 99382 99398 99400 99401 99402 99418 99419 99428 99877 99898 99909 100356 100362 100378 100389 100836 100843 100857 100858 100870 101316 101324 101338 101339 101351 101386 101387 101388 101389 101390 101391 101392 101393 101796 101805 101819 101820 101832 101866 101873 101874 102276 102285 102312 102345 102354 102355 102756 102781 102793 102809 102810 102811 102812 102825 102835 103246 103262 103288 103289 103293 103305 103315 103717 103727 103742 103754 103768 103774 103785 103796 104207 104208 104223 104235 104248 104254 104255 104265 104276 104678 104688 104727 104735 104746 104756 105158 105168 105169 105183 105195 105207 105215 105226 105237 105639 105650 105664 105675 105688 105696 105707 105718 106120 106130 106144 106168 106169 106176 106187 106188 106199 106200 106601 106611 106625 106635 106649 106656 106657 106668 106681 107082 107092 107093 107105 107129 107130 107137 107148 107161 107562 107563 107573 107586 107610 107617 107629 107641 108043 108053 108066 108075 108090 108091 108098 108109 108121 108524 108534 108547 108555 108571 108578 108579 108590 108601 109004 109015 109027 109034 109035 109052 109059 109070 109081 109485 109486 109495 109508 109533 109540 109550 109551 109561 109966 109967 109975 109988 110014 110021 110022 110031 110041 110447 110448 110455 110469 110473 110495 110503 110504 110512 110521 110928 110929 110935 110950 110951 110975 110984 110992 110993 111001 111410 111411 111412 111413 111414 111456 111464 111465 111473 111481 111937 111945 111954 111955 111956 111957 111958 111959 111960 111961 112417 112418 112426 112898 112899 112906 113380 113386 113861 113866 114342 114343 114344 114345 115331 115332 115333 115334 115335 115740 115741 115742 115810 115815 115816 116217 116218 116219 116223 116224 116225 116288 116289 116297 116696 116697 116705 116706 116768 116777 117176 117186 117247 117248 117257 117656 117667 117727 117728 117737 118135 118147 118208 118217 118615 118688 118689 118697 119095 119108 119169 119177 119567 119569 119570 119571 119576 119588 119589 119650 119657 120044 120046 120051 120052 120056 120069 120130 120137 120524 120532 120537 120550 120617 121004 121013 121017 121031 121090 121097 121484 121493 121494 121498 121512 121577 121964 121978 121992 122050 122057 122445 122454 122459 122472 122531 122537 122924 122925 122934 122939 122940 122953 123012 123017 123405 123415 123433 123493 123497 123886 123895 123901 123914 123973 123977 124376 124381 124394 124454 124457 124846 124847 124856 124857 124862 124875 124934 124938 125327 125337 125342 125343 125356 125415 125418 125818 125824 125836 125895 125898 126288 126298 126304 126305 126316 126376 126378 126768 126779 126785 126796 126856 126857 127249 127266 127267 127275 127276 127740 127747 127748 127755 127759 127760 127761 128210 128221 128229 128235 128238 128241 128242 128701 128710 128713 128717 128722 129171 129181 129190 129191 129192 129196 129203 129220 129221 129222 129223 129224 129652 129662 129671 129676 129683 129684 129699 129700 129704 130133 130142 130155 130165 130179 130185 130614 130622 130635 130646 130658 130666 131095 131103 131114 131126 131127 131138 131146 131575 131576 131583 131594 131607 131617 131627 132056 132058 132063 132072 132074 132088 132097 132107 132538 132539 132540 132541 132542 132543 132553 132554 132568 132575 132577 132588 133033 133048 133049 133055 133068 133514 133529 133535 133536 133537 133549 133994 134009 134016 134017 134029 134475 134489 134496 134497 134510 134955 134956 134970 134977 134991 134992 135436 135437 135450 135457 135458 135472 135473 135918 135930 135938 135954 136398 136411 136419 136434 136878 136879 136891 136892 136900 136915 137360 137372 137373 137381 137395 137396 137840 137853 137862 137877 138321 138334 138343 138357 138358 138801 138802 138815 138816 138823 138838 138839 139282 139283 139296 139304 139319 139763 139764 139777 139784 139800 140244 140257 140265 140280 140725 140737 140745 140746 140761 141205 141217 141226 141241 141685 141686 141696 141706 141721 142166 142176 142187 142201 142646 142647 142655 142656 142667 142668 142681 143127 143128 143135 143148 143160 143609 143610 143611 143612 143613 143614 143615 143628 143629 143640 144109 144119 144120 144558 144559 144560 144561 144562 144576 144577 144578 144589 144590 144598 144599 145037 145043 145055 145059 145070 145071 145078 145516 145524 145535 145540 145551 145552 145557 145558 145560 145561 145562 145563 145995 146005 146014 146020 146032 146033 146034 146035 146036 146037 146038 146039 146043 146044 146475 146485 146494 146501 146518 146524 146955 146966 146973 146981 146997 147004 147005 147434 147435 147453 147462 147463 147477 147486 147914 147926 147943 147957 147966 147967 148394 148407 148413 148424 148435 148436 148437 148448 148874 148887 148894 148904 148915 148928 149353 149368 149373 149384 149385 149395 149396 149397 149409 149833 149848 149853 149876 149877 149890 150313 150329 150333 150345 150357 150358 150371 150793 150810 150814 150826 150839 150851 151273 151291 151295 151307 151319 151320 151331 151754 151772 151776 151787 151800 151801 151811 152234 152252 152257 152268 152282 152292 152715 152733 152738 152762 152763 152772 153195 153214 153219 153229 153230 153243 153253 153676 153694 153695 153700 153701 153710 153724 153733 153734 154156 154157 154175 154182 154191 154192 154204 154205 154214 154215 154637 154638 154656 154663 154673 154685 154695 155119 155136 155144 155154 155166 155176 155600 155601 155616 155634 155646 155657 156081 156095 156105 156115 156127 156137 156562 156575 156586 156595 156607 156617 157043 157044 157055 157075 157088 157097 157524 157535 157546 157547 157555 157568 157569 157577 158005 158015 158027 158035 158049 158050 158057 158487 158495 158507 158508 158515 158531 158532 158533 158534 158535 158536 158967 158975 158988 158989 158994 158995 159448 159454 159469 159470 159471 159472 159473 159474 159929 159933 159934 160409 160410 160411 160412 ];
backgroundInd = [5 6 7 8 9 10 11 12 14 15 16 17 19 39 80 83 84 95 119 120 124 484 502 519 963 984 1038 1443 1465 1536 1947 1995 2402 2427 2439 2474 2534 2882 2907 2919 2951 2952 2977 3362 3388 3496 3842 3879 3908 3909 4323 4349 4386 4417 4803 4839 5284 5309 5344 5765 5789 5790 5798 5821 5898 6247 6270 6298 6338 6728 6778 7210 7232 7233 7237 7690 7714 7733 7779 7818 8171 8172 8194 8197 8211 8653 8676 8739 9134 9155 9168 9220 9615 9635 9645 9738 10095 10114 10576 10601 10603 11056 11081 11537 11621 12017 12039 12040 12138 12497 12517 12518 12583 12996 13458 13473 13474 13543 13938 13951 13952 14058 14418 14429 14430 14899 14908 14909 14984 15379 15385 15859 15863 15864 15867 15977 16339 16342 16347 16425 16801 16819 16821 17282 17298 17301 17306 17307 17385 17763 17777 17781 17786 17866 17896 18244 18245 18246 18253 18254 18255 18267 18346 18727 18728 18729 18730 18731 18732 18741 18747 18826 19228 19303 19701 19708 19780 19816 20181 20189 20258 20259 20661 20669 21141 21150 21621 21736 22101 22582 22591 23063 23073 24033 24136 24505 24529 24530 24532 24533 24534 24536 24537 24538 24985 24995 25006 25007 25019 25460 25466 25476 25485 25486 25500 25501 25576 25939 25940 25947 25956 25965 25981 26418 26419 26428 26437 26444 26445 26462 26536 26895 26896 26897 26909 26918 26922 26923 26943 27373 27374 27375 27390 27398 27399 27400 27401 27423 27852 27853 27870 27871 27879 27904 28331 28332 28352 28453 28811 28832 28833 28865 28932 29313 29412 29794 29826 29892 30274 30787 30852 31267 31716 31747 31814 32294 32677 32708 32775 33158 33255 33639 33668 33735 33736 34120 34148 34628 35081 35082 35108 35588 36043 36068 36524 36548 37004 37028 37485 37486 37507 37508 37966 37987 38447 38466 38467 38927 38943 38944 38945 39408 39421 39422 39889 39897 39898 39899 39900 40376 40377 40850 41299 41300 41336 41780 41811 41817 42261 42297 42742 42757 42758 42772 42778 43223 43237 43238 43252 43258 43259 43271 43272 43273 43274 43275 43276 43277 43278 43279 43703 43716 43718 43733 43739 43746 43747 43750 43760 43761 44184 44196 44219 44227 44228 44242 44664 44665 44674 44675 44677 44678 44694 44700 44706 44707 44722 44723 45122 45145 45152 45153 45154 45157 45182 45183 45184 45203 45602 45626 45628 45629 45630 45631 45636 45655 45656 45684 46083 46106 46107 46115 46116 46136 46563 46587 46595 46616 46617 46644 46645 47043 47074 47097 47125 47523 47577 47606 48004 48033 48058 48086 48484 48512 48538 48566 48964 48992 49019 49047 49445 49472 49499 49527 49979 50007 50432 50460 50487 50940 51392 51421 51447 51872 51901 51927 52407 52832 52833 52863 52887 53313 53344 53367 53794 53825 53826 53827 53847 54275 54276 54307 54308 54327 54757 54788 54789 54806 55238 55239 55269 55286 55689 55720 55749 55750 55765 55771 55772 55774 55775 55776 55778 55779 55780 55781 55782 55783 56171 56201 56202 56230 56231 56244 56248 56249 56250 56263 56264 56265 56651 56653 56682 56711 56712 56723 56724 56727 56728 56746 56747 57133 57134 57135 57163 57192 57193 57202 57203 57206 57228 57616 57644 57674 57682 57685 57708 58097 58124 58154 58162 58163 58164 58189 58577 58605 58635 58636 59149 59566 59597 59629 60017 60046 60078 60110 60527 60559 61007 61040 61070 61458 61488 61968 61969 62002 62419 62450 62457 62458 62459 62460 62461 62462 62483 62510 62899 62931 62936 62942 63379 63412 63413 63414 63415 63422 63860 63862 63902 63924 63950 64340 64343 64382 64821 64824 64861 64886 64910 65301 65304 65305 65341 65367 65390 65781 65786 65820 65821 65848 65870 66266 66300 66328 66350 66741 66747 66780 66809 66830 67227 67259 67260 67290 67310 67701 67708 67739 67770 67771 67789 68188 68219 68251 68252 68269 68661 68668 68699 68732 69140 69149 69179 69213 69229 69619 69629 69630 69659 69694 69708 70099 70110 70111 70140 70174 70188 70576 70578 70592 70593 70620 70655 70668 70687 70688 70689 70690 71074 71075 71101 71135 71147 71148 71159 71161 71162 71164 71166 71170 71536 71557 71581 71626 71627 71637 71638 72016 72038 72061 72062 72096 72105 72106 72115 72116 72131 72496 72520 72521 72542 72577 72585 72594 72612 73001 73002 73022 73057 73058 73065 73066 73074 73456 73482 73503 73538 73539 73540 73546 73547 73552 73963 73983 74020 74021 74027 74028 74029 74030 74031 74052 74416 74464 74501 74502 74923 74944 74982 75404 75425 75463 75492 75856 75884 75906 75943 75944 76365 76386 76387 76424 76425 76816 76846 76905 76906 76933 77296 77348 77386 77776 77807 77867 78256 78288 78309 78347 78374 78737 78790 78828 79218 79249 79270 79334 79699 79729 79751 79788 80180 80269 80294 80661 80690 80712 81142 81171 81193 81254 81674 81734 82131 82154 82635 82646 82647 82648 82649 82693 83092 83115 83125 83130 83151 83547 83596 83597 83604 83610 83653 84052 84084 84089 84111 84112 84508 84558 84559 84560 84563 84569 84592 84612 84989 85013 85040 85041 85042 85043 85049 85073 85469 85529 85554 85572 85950 85973 86009 86035 86051 86454 86489 86516 86529 86530 86911 86969 86997 87008 87414 87449 87478 87486 87487 87872 87930 87958 87965 88352 88375 88410 88439 88445 88833 88855 88891 88919 88925 89313 89370 89371 89400 89401 89405 89793 89816 89849 89850 89851 89881 89886 90241 90297 90298 90329 90330 90331 90362 90366 90367 90721 90778 90808 90809 90811 90844 90848 90849 90850 91202 91233 91259 91288 91289 91290 91324 91325 91326 91327 91328 91329 91330 91682 91714 91740 91768 91769 92162 92194 92221 92248 92294 92296 92298 92643 92674 92702 92703 92728 92771 93155 93183 93208 93250 93604 93635 93636 93664 93689 93729 93730 94116 94144 94209 94565 94597 94625 94650 95077 95078 95106 95526 95558 95559 95587 95610 96006 96040 96067 96091 96487 96520 96521 96548 96968 97002 97029 97052 97448 97482 97483 97510 97532 97929 97963 97991 98409 98444 98471 98493 98890 98924 98952 98974 99370 99433 99455 99465 99466 99851 99852 99885 99914 99926 99928 99929 99931 99935 99943 99944 99946 100333 100365 100394 100405 100413 100414 100415 100416 100417 100423 100426 100813 100814 100821 100822 100823 100824 100825 100827 100846 100884 100897 100899 100903 100904 100905 101295 101296 101297 101298 101299 101308 101309 101310 101326 101327 101363 101377 101378 101379 101380 101381 101382 101383 101384 101791 101807 101863 102272 102273 102287 102322 102323 102343 102754 102768 102802 102823 103234 103235 103248 103249 103716 103730 103762 104196 104210 104211 104243 104676 104691 104724 105157 105171 105172 105637 105652 105684 106118 106133 106598 106614 106615 106646 106693 107078 107096 107559 107577 107578 107607 107652 108039 108058 108131 108520 108539 108610 109000 109020 109048 109090 109481 109502 109570 109961 109983 110049 110442 110464 110529 110922 110944 110971 111008 111403 111423 111424 111488 111883 111904 112363 112385 112412 112448 112843 112928 113323 113345 113408 113803 114282 114333 114762 115242 115265 115722 115798 115799 116202 116226 116255 116275 116276 116277 116279 116280 116682 116706 116754 116755 117162 117186 117216 117233 117241 117642 117667 117708 117710 117711 118122 118148 118177 118187 118202 118628 118629 118630 118631 118658 118667 119082 119112 119139 119146 119163 119562 119593 119621 119644 120042 120073 120103 120104 120105 120124 120522 120554 120555 121002 121035 121036 121037 121084 121482 121517 121962 121998 121999 122442 122480 122524 122922 122961 123005 123441 123451 123452 123453 123454 123455 123485 123882 123922 123930 123936 124363 124402 124409 124417 124446 124843 124882 124889 124926 125362 125369 125379 125804 125859 125887 126323 126328 126329 126340 126368 126765 126804 126821 127285 127288 127301 127328 127725 127765 127766 127767 127781 127809 128262 128289 128686 128743 129250 129704 129730 130127 130211 130666 130667 130668 130669 131088 131150 131172 131184 131630 131653 131663 132049 132110 132141 132142 132590 132614 132620 132621 133071 133095 133100 133551 133576 133577 133970 134031 134057 134058 134059 134511 134512 134513 134538 134931 134993 134994 135018 135475 135476 135478 135497 135892 135960 135976 135977 136373 136441 136442 136455 136864 136865 136866 136867 136868 136923 136924 136925 136934 136935 137334 137342 137343 137349 137350 137376 137406 137407 137414 137815 137816 137817 137818 137819 137820 137821 137831 137856 137887 137892 137893 138312 138336 138368 138369 138370 138371 138816 139273 139777 140234 140258 140288 140738 140768 141218 141674 141699 142164 142180 142634 142644 142660 142661 142688 143114 143124 143141 143604 143622 143648 144073 144084 144103 144608 145031 145044 145064 145511 145525 145568 145990 146005 146025 146049 146469 146486 146506 146530 146949 146966 147011 147447 147467 147491 147909 147927 147972 148428 148888 148933 149368 149414 149830 149870 149895 150329 150351 150375 150376 150810 150831 150856 151312 151336 151337 151750 151771 151792 151817 152273 152731 152754 153191 153211 153235 153716 154151 154173 154197 154677 155112 155133 155158 155614 156119 156553 156575 157080 157514 157536 157561 158016 158475 158476 158978 159003 159437 159918 159939 159964 160399 160420 160445 160880 160900 160901 160926 161361 161381 161382 161406 161842 161843 161844 161845 161846 161847 161849 161850 161851 161852 161862 161886 162342 162819 162820 ];
L = superpixels(X,1286,'IsInputLab',true);

% Convert L*a*b* range to [0 1]
scaledX = prepLab(X);
BW = lazysnapping(scaledX,L,foregroundInd,backgroundInd);

% Create masked image.
maskedImage = RGB;
maskedImage(repmat(~BW,[1 1 3])) = 0;
end

function out = prepLab(in)

% Convert L*a*b* image to range [0,1]
out = in;
out(:,:,1)   = in(:,:,1) / 100;  % L range is [0 100].
out(:,:,2:3) = (in(:,:,2:3) + 100) / 200;  % a* and b* range is [-100,100].

end